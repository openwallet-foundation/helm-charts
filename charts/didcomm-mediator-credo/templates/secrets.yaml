{{ $agentSecretName := printf "%s-agent" (include "mediator.fullname" .) }}
{{- $walletKey := include "getOrGeneratePass" (dict "Namespace" .Release.Namespace "Kind" "Secret" "Name" $agentSecretName "Key" "wallet-key" "Length" 32) }}
{{- $projectId := include "getOrCreateSecret" (dict "Namespace" .Release.Namespace "Kind" "Secret" "Name" $agentSecretName "Key" "firebase-project-id" "DefaultValue" "project-id") }}
{{- $clientEmail := include "getOrCreateSecret" (dict "Namespace" .Release.Namespace "Kind" "Secret" "Name" $agentSecretName "Key" "firebase-client-email" "DefaultValue" "firebase-client@example.com") }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ $agentSecretName }}
  labels:
    {{- include "mediator.labels" . | nindent 4 }}
  annotations:
    "helm.sh/resource-policy": keep
type: Opaque
data:
  wallet-key: {{ $walletKey }}
  firebase-project-id: {{ $projectId }}
  firebase-client-email: {{ $clientEmail }}
stringData:
  pickup-connection-json: "{}"
  firebase-private-key: |
    -----BEGIN PRIVATE KEY-----
    dummykey
    -----END PRIVATE KEY-----
